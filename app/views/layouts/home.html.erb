<!DOCTYPE html>
<html>
  <head>
    <title>Headcount</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload" %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <meta name="csrf-token" content="<%= form_authenticity_token %>">

  </head>

<body class="bg-gray-900 text-gray-100 tracking-wider leading-normal">
  
<!-- Navbar -->
<nav class="bg-gray-800 shadow">
  <div class="max-w-6xl mx-auto px-4">
    <div class="flex justify-between items-center py-6">
      <div>
        <button onclick="location.href='/users/sign_in'"class="bg-gray-500 hover:bg-gray-400 text-white font-bold py-2 px-4 rounded">
          Member
        </button>
        
      </div>
        <h1 class="mb-4 text-3xl font-extrabold text-gray-900 dark:text-white md:text-5xl lg:text-6xl">HEADCOUNT</h1>

      <div>

        <!-- Contact/Admin button -->
        <button onclick="location.href='/admin'" class="bg-gray-500 hover:bg-red-400 text-white font-bold py-2 px-4 rounded">
          Admin
        </button>
      </div>
    </div>
  </div>
</nav>

<!-- Main Content Area -->
<main class="py-10">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <h1 class="text-3xl font-bold text-center text-white mb-10">Upcoming Parties</h1>
    <!-- Posts feed -->
    <div class="space-y-6">
      <% @parties.each do |party| %>
        <div class="bg-gray-800 rounded-lg p-4 shadow-lg">
          <h2 class="text-xl text-white font-bold"><%= party.title %></h2>
          <p class="text-gray-300"><%= party.description %></p>
          <div class="flex justify-between items-center mt-4">
            <%= button_to "Interested: #{party.interest_count}", increment_interest_party_path(party), method: :patch, form_class: "inline", class: "bg-blue-500 hover:bg-green-400 text-white font-bold py-2 px-4 rounded" %>


            <span class="text-gray-400 text-sm">Posted <%= time_ago_in_words(party.created_at) %> ago</span>
          </div>
        </div>
      <% end %>
    </div>
  </div>
  <script>
    function incrementInterest(partyId) {
  const url = `/parties/${partyId}/edit`;
  const options = {
    method: 'PATCH',
    headers: {
      'X-CSRF-Token': document.querySelector('[name="csrf-token"]').content,
      'Content-Type': 'application/json'
    },
    credentials: 'same-origin'
  };

  fetch(url, options)
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        const countSpan = document.getElementById(`interest-count-${partyId}`);
        let currentCount = parseInt(countSpan.textContent, 10);
        countSpan.textContent = currentCount + 1;
      }
    })
    .catch(error => console.error('Error:', error));
}
</script>
</main>

<!-- Footer -->
<footer class="bg-gray-800 shadow py-8 mt-10">
  <div class="max-w-6xl mx-auto px-4 flex justify-center text-gray-400">
    Â© 2024 Headcount. All rights reserved.
  </div>
</footer>

</body>
</html>

